// Init slider
$(document).ready(function(){
  $slides = $('.slider').find($('.slide__container'));
  $slides.find('.slide__content').append('<div class="dots"></div>')
  $slides.each(function(i){
    i++
    var $this = $(this);
    var dataNumber =  i++;
    var $dot = '<a class="dots__item" data-product="'+dataNumber+'" href="#"></a>';
    $('.dots').append($dot);
    $this.attr('data-product', dataNumber);
  })
  $color = $('[data-product="1"]').find('.slide__item--variants a:first-child').attr('data-color');
  $('[data-color="'+$color+'"]').addClass('active');
  setTimeout(function(){
    $('[data-product="1"]').addClass('active');
  },100);

  $('.slide__item--variants a').on('click', function(e){
    activateVariant($(this),e);
  });

  $('.dots .dots__item').on('click', function(e){
    activateProduct($(this),e);
    $variant = $('.slide__container.active').find('.slide__item--variants a').first();
    activateVariant($($variant),e);
  });


  $(".slide__item").on('mouseenter', function(){
    $(this).find('.slide__image--skew').addClass('slide--enlarge');
    $(this).siblings().find('.slide__image--skew').addClass('slide--shrink');
  });

  $(".slide__item ").on('mouseleave', function(){
    $(this).find('.slide__image--skew').removeClass('slide--enlarge');
    $(this).siblings().find('.slide__image--skew').removeClass('slide--shrink');
  });

});

function activateProduct(el, e){
  $this = el;
  e.preventDefault();
  $product = $($this).attr('data-product');
  $('[data-product]').removeClass('active');
  $('[data-product="'+$product+'"]').addClass('active')
}
function activateVariant(el, e){
  $this = el;
  e.preventDefault();
  $color = $($this).attr('data-color');
  $('[data-color]').removeClass('active');
  $('[data-color="'+$color+'"]').addClass('active');
}

//sharedCount plugin

jQuery.sharedCount = function(url, fn) {
    url = encodeURIComponent(url || location.href);
    var domain = "//api.sharedcount.com/v1.0/"; /* SET DOMAIN */
    var apikey = "552c824734aeca5f26be44bdd00b94854477986c" /*API KEY HERE*/
    var arg = {
      data: {
        url : url,
        apikey : apikey
      },
        url: domain,
        cache: true,
        dataType: "json"
    };
    if ('withCredentials' in new XMLHttpRequest) {
        arg.success = fn;
    }
    else {
        var cb = "sc_" + url.replace(/\W/g, '');
        window[cb] = fn;
        arg.jsonpCallback = cb;
        arg.dataType += "p";
    }
    return jQuery.ajax(arg);
};


jQuery(document).ready(function($){
  $.sharedCount(location.href, function(data){
      $("#facebook").text(data.Facebook.total_count);
      $("#linkedin").text(data.LinkedIn);
      $("#pinterest").text(data.Pinterest);
      $("#stumbles").text(data.StumbleUpon);
      $("#comments").text(data.Facebook.comment_count);
      $("#plusones").text(data.GooglePlusOne);
      $("#sharedcount").fadeIn();

});
});
console.log(jQuery.sharedCount('https://makingsense.com/'));
